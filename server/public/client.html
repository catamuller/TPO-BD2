<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Add, update, or delete a client</title>
    </head>
    <body>
        <form
            onsubmit="submit"
            style="display: flex; flex-direction: column; width: 25%"
        >
            <label for="id">Nro de Cliente</label>
            <input id="id" type="number" />
            <label for="name">Nombre</label>
            <input id="name" type="text" />
            <label for="surname">Apellido</label>
            <input id="surname" type="text" />
            <label for="address">Direcci√≥n</label>
            <input id="address" type="text" />
            <label for="active">Activo</label>
            <input id="active" type="number" />

            <button type="submit" id="formType" value="upsert">
                Agregar o Actualizar Cliente
            </button>
            <button type="submit" id="formType" value="delete">
                Eliminar Cliente
            </button>
        </form>
        <p id="status"></p>
    </body>
    <script>
        function submit(event) {
            event.preventDefault();

            const id = parseInt(document.getElementById("id").value);
            const name = document.getElementById("name").value;
            const surname = document.getElementById("surname").value;
            const address = document.getElementById("address").value;
            const active = parseInt(document.getElementById("active").value);
            const action = document.getElementById("formType").value;

            (async (value) => {
                if (value === "upsert") {
                    const response = await fetch("/client", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            id,
                            name,
                            surname,
                            address,
                            active,
                            action
                        })
                    });

                    const data = await response.text();
                    document.getElementById("status").innerText = data;
                } else if (value === "delete") {
                    const response = await fetch("/client", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            id,
                            action
                        })
                    });

                    const data = await response.text();
                    document.getElementById("status").innerText = data;
                }
            })();
        }

        document.querySelector("form").addEventListener("submit", submit);
    </script>
</html>
